/*!
 * jQuery.locationPicker() plugin.
 *
 * @author Lupo Montero <lupo@e-noise.com>
 */
(function(b){var d={proxy_url:"proxy.php",flags_path:"img/flags"};var c=function(g,o,h){var p,s,n,l,m,f,r=[],v,q,t,u,e="";if(!o||!o.length){return}for(p=0,s=o.length;p<s;p++){v=o[p];q={value:"",title:"",subtitle:null,img:"",data:{raw:v}};t=v.address_components||[];for(n=0,l=t.length;n<l;n++){for(m=0,f=t[n].types.length;m<f;m++){if(t[n].types[m]==="country"){q.data.country={short_name:t[n].short_name,long_name:t[n].long_name}}else{if(t[n].types[m]==="locality"){q.data.locality={short_name:t[n].short_name,long_name:t[n].long_name}}else{if(t[n].types[m]==="administrative_area_level_1"){q.data.state={short_name:t[n].short_name,long_name:t[n].long_name}}}}}}e="";if(q.data.locality){e+=q.data.locality.short_name}if(q.data.state&&q.data.state.short_name&&(!q.data.locality||q.data.state.short_name!==q.data.locality.short_nameshort_name)){if(e.length>0){e+=", "}e+=q.data.state.short_name}if(q.data.country){e+=", "+q.data.country.short_name;u=q.data.country.short_name.toLowerCase();if(g.flags_path){q.img=u+".png"}}q.value=e.replace(/, /g,",");q.title=e;r.push(q)}h(r)};var a=function(e,f){var g;f.suggest({img_path:e.flags_path,search:function(i,h){if(g){g.abort()}g=b.ajax({url:e.proxy_url+"?s="+encodeURIComponent(i),dataType:"json",success:function(j){if(!j||!j.status||j.status!=="OK"){}c(e,j.results,h)}})},select:function(h,i){e.select&&e.select(h,i)},clear:function(){if(g){g.abort()}e.clear&&e.clear()}})};b.fn.locationPicker=function(e){var f=b.extend({},d,e||{});b(this).each(function(g){a(f,b(this).addClass("location-picker"))})}})(jQuery);